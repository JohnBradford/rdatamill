
# for displaying test in UI for data entry

openTest <- function(){



inputTest <<- input$Analysis
# inputTest <- 'coffee test'

open_Test <- lapply(inputTest, function(x){
testForm <- read.csv(file="testForm.csv")
testForm <- testForm[testForm$Test == x,]
test_max <- max(testForm$Version)
testForm <- testForm[testForm$Version == test_max,]
test_name <- unique(testForm$Test)
test_active <-  unique(testForm$Active)


if(unique(testForm$Active) == TRUE){
output <- lapply(unique(testForm$Question_order),function(order){

 test_question_1 <- as.character(testForm$Question[testForm$Question_order == order])

   List_test_1 <- as.character(testForm$lists[testForm$Question_order == order])
  if(length(List_test_1) == 0L){
    List_test_1 <- ""
  }
  if(length(List_test_1) != 0L){
    List_test_1 <- strsplit(List_test_1 , ",")
    names(List_test_1) <-  List_test_1}

   min_test_1 <- as.numeric(testForm$min[testForm$Question_order == order])
   if(length(min_test_1) == 0L){
     min_test_1 <- 0
   }

   max_test_1 <- as.numeric(testForm$max[testForm$Question_order == order])
   if(length(max_test_1) == 0L){
     max_test_1 <- 0
   }
   step_test_1 <- as.numeric(testForm$step[testForm$Question_order == order])
   if(length(step_test_1) == 0L){
     step_test_1 <- 0
   }

  Input_test_1 <-  testForm$types[testForm$Question_order == order]
#   if(Input_test_1 == 'text box')
#     input_type_test_1_2 <- 'textInput'



 return(list(
# if(order == "Question_test_1"){ paste("div(id = \"form\",")},
if(order == "Question_test_1"){eval(h3(inputTest))},

if(order == "Question_test_1"){eval(h5(paste("Version:",test_max,"",sep="")))},

if(Input_test_1== 'text box'){
textInput(order, label = test_question_1)},
if(Input_test_1== 'list'){
selectInput(order,label = test_question_1,choices = c(List_test_1))},
if(Input_test_1== 'numeric'){
  sliderInput(order,label = test_question_1, value = 0, min = min_test_1,max = max_test_1, step = step_test_1)}
)
)


})}

if(testForm$Active == FALSE){
output <- div(
  id = "form",
  h3("No active test available"))

}


return(list(c(output)))
})
return(list(open_Test))
}


